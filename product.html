<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Product</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    .product-detail { padding:40px; display:flex; gap:40px; }
    .product-detail img { width:420px; max-width:40vw; height:auto; }
    .product-info h1 { font-size:22px; text-transform:uppercase; margin-bottom:8px; }
    .product-info .price { font-size:18px; margin-top:12px; font-weight:700; }
    .breadcrumb-link {
      color: #000;
      text-decoration: none;
      cursor: pointer;
    }
    .breadcrumb-link:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <header class="navbar">
    <div class="nav-wrap">
      <div></div>
      <div class="logo">
        <img src="logo.png" alt="LIL DOUGH"
             onerror="this.onerror=null;this.src='https://picsum.photos/seed/logo/200/40'">
      </div>
      <div></div>
    </div>
  </header>

  <!-- Controls bar with breadcrumb -->
  <section class="controls">
    <div class="controls-left">
      <div id="breadcrumb" class="crumb">PRODUCT</div>
    </div>
  </section>

  <main id="product-main" style="padding:24px;">
    <!-- filled by script -->
  </main>

  <script src="data.js"></script>
  <script>
    (function(){
      const params = new URLSearchParams(location.search);
      const id = params.get('id');
      const main = document.getElementById('product-main');
      const breadcrumbEl = document.getElementById('breadcrumb');
      const all = window.PRODUCTS || [];
      const p = all.find(x => x.id === id);

      function createCrumb(label, category) {
        if (!category) {
          return `<span>${label}</span>`;
        }
        return `<a class="breadcrumb-link" href="index.html" data-category="${category}">${label}</a>`;
      }

      if (!p) {
        main.innerHTML = '<p style="padding:24px;">Product not found. <a href="index.html">Back to store</a></p>';
        breadcrumbEl.textContent = 'NOT FOUND';
      } else {
        // build breadcrumb trail from categories
        let trail = '';
        if (p.categories && p.categories.length) {
          trail = p.categories.map(cat =>
            createCrumb(cat.toUpperCase(), cat)
          ).join(' / ');
        }
        // add product name at the end (not clickable)
        trail += ` / ${p.name.toUpperCase()}`;
        breadcrumbEl.innerHTML = trail;

        main.innerHTML = `
          <div class="product-detail">
            <img src="${p.image}" alt="${p.name}"
                 onerror="this.onerror=null;this.src='https://picsum.photos/seed/${encodeURIComponent(p.id)}/800/800'">
            <div class="product-info">
              <h1>${p.name}</h1>
              <div>${p.colors}</div>
              <div class="price">$${Number(p.price).toLocaleString()}</div>
              <p style="margin-top:18px;color:#444;">Please buy this.</p>
            </div>
          </div>
        `;

        // wire breadcrumb clicks so they pass category info to index.html
        document.querySelectorAll('.breadcrumb-link').forEach(link => {
          link.addEventListener('click', (e) => {
            e.preventDefault();
            const cat = link.getAttribute('data-category');
            // go to index.html with hash or query param
            window.location.href = `index.html?category=${encodeURIComponent(cat)}`;
          });
        });
      }
    })();
  </script>
</body>
</html>
